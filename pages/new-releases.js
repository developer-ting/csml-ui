// MODULES //
import { useEffect, useRef, useState } from "react";
import ScrollOut from "scroll-out";

// COMPONENTS //
import Head from "next/head";
import Footer from "../src/components/Footer";
import Header from "../src/components/Header";
import InsideBanner from "@/components/InsideBanner";
import Loader from "@/components/Loader";
import { ServerHeaders } from "@/utils/RequestHeaders";
// SECTIONS //
// PLUGINS //

// STYLES //
import styles from "../src/styles/pages/NewReleases.module.scss";

//	IMAGES	//
import banner from "../public/img/new-releases/banner.jpg";
import productImg from "../public/img/new-releases/product-img.png";
import arrow from "../public/img/arrow.svg";

/** New Releases Page */
export default function NewReleases({ GamesData }) {
	console.log(GamesData);
	useEffect(() => {
		ScrollOut({
			once: true,
		});
	}, []);

	return (
		<div>
			<Head>
				<title>New Releases</title>
				<meta name="description" content="Generated by create next app" />
				<link rel="icon" href="/favicon.ico" />
			</Head>

			<Header />
			<Loader />
			<main className={`${styles.NewReleasesPage}`}>
				<InsideBanner
					bannerTitle="Discover fresh adventures with <br/> our new releases"
					bannerImg={banner.src}
					mobileImg={banner.src}
				/>

				<section
					className={`${styles.NewReleasesSection} dot_animation_box ptb_100`}
				>
					<div className="container">
						<div className="ImgHeadingArrowStyle">
							{GamesData.data.map((item) => {
								return (
									<div className="BlockInsideInfo" key={item.attributes.GameName}>
										<div className="ProductImg">
											<img
												src={`${process.env.NEXT_PUBLIC_STRAPI_DO_BASE_URL}${item.attributes.GameImg.data.attributes.url}`}
												className="border_12"
												alt="product img"
											/>
										</div>
										<div className="text_btn_sec f_r_aj_between">
											<h5 className="paraTxt_18 text_500 color_white">
												{item.attributes.GameName}
											</h5>
											<a href="#" rel="noreferrer">
												<button className="btn_arrow">
													<span className={`${styles.arrow_one} arrow_one`}>
														<img src={arrow.src} />
													</span>
													<span className={`${styles.arrow_two} arrow_two`}>
														<img src={arrow.src} />
													</span>
												</button>
											</a>
										</div>
									</div>
								);
							})}
						</div>
					</div>
				</section>
			</main>
			<Footer />
		</div>
	);
}

export async function getStaticProps() {
	//
	const GamesRes = await fetch(
		`${process.env.STRAPI_DO_BASE_URL}/api/games?populate=*&filters[IsNew][$eq]=true`,
		ServerHeaders
	);
	const GamesData = await GamesRes.json();

	return {
		props: {
			GamesData,
		},
		revalidate: 10,
	};
}
